<!DOCTYPE html><html><head><title>FAQ・トラブルシューティング - N予備校プログラミングコース</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="next-head-count" content="3"/><link rel="preload" href="/faq/_next/static/css/1d401a81e23b9a9127fd.css" as="style"/><link rel="stylesheet" href="/faq/_next/static/css/1d401a81e23b9a9127fd.css" data-n-g=""/><link rel="preload" href="/faq/_next/static/css/6a0d4c9cf31e47d142cd.css" as="style"/><link rel="stylesheet" href="/faq/_next/static/css/6a0d4c9cf31e47d142cd.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/faq/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/faq/_next/static/chunks/webpack-bcb40c1eac2319a30a96.js" defer=""></script><script src="/faq/_next/static/chunks/framework-92300432a1172ef1338b.js" defer=""></script><script src="/faq/_next/static/chunks/main-2bebcc8f6230cc335f3c.js" defer=""></script><script src="/faq/_next/static/chunks/pages/_app-8f72113b54d06ed9692b.js" defer=""></script><script src="/faq/_next/static/chunks/996-9333713592b33abcda8c.js" defer=""></script><script src="/faq/_next/static/chunks/97-da7d8bf40c4af9345eea.js" defer=""></script><script src="/faq/_next/static/chunks/pages/%5B...slug%5D-fa3a9175ea6b57d51520.js" defer=""></script><script src="/faq/_next/static/T1vjYJgyrlBWundsx9FW2/_buildManifest.js" defer=""></script><script src="/faq/_next/static/T1vjYJgyrlBWundsx9FW2/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><header class="px-5 "><div class="max-w-4xl mx-auto pt-5 pb-2 border-gray-100 border-b"><div class="flex items-center"><div class="icon ml-1 mb-0.5 cursor-pointer"><img src="/faq/images/nyobiko.png" width="100" height="100"/></div><h1 class="leading-4 pl-4 cursor-pointer"><div class="ml-1">N予備校プログラミングコース</div><div class="font-bold text-xl ml-1">FAQ・トラブルシューティング</div></h1></div></div></header><main class="px-5 bg-blue-50 pt-5 pb-20 min-h-screen"><div class="max-w-4xl mx-auto bg-white rounded-2xl px-4 pb-20"><div class="markdown-body"><h1>Docker 関連のトラブル</h1>
<hr>
<p><strong>目次</strong></p>
<ul>
<li><a href="#1">(1) Docker Desktop がインストールできない</a></li>
<li><a href="#2">(2) docker-compose up -d（コンテナ起動）で失敗する</a></li>
<li><a href="#3">(3) (winpty) docker-compose exec app bash で失敗する</a></li>
</ul>
<hr>
<h2>(1) Docker Desktop がインストールできない <a id="1"></a></h2>
<h3>問題詳細</h3>
<p>コンピュータの記憶容量の残りが十分あるにもかかわらず、Docker Desktop がインストールできない場合があります。</p>
<h3>原因</h3>
<p>OS が Docker が対応していない古いバージョンであることが原因です。
Docker が対応している OS のバージョンは、次の通りです（2021.7.12 最終確認）。</p>
<ul>
<li>macOS（Intel の CPU を搭載する端末）：<strong>バージョン 10.14（Mojave）以降</strong></li>
<li>macOS（Apple silicon を搭載する端末）：<strong>Rosetta 2 がインストールされていること</strong>
<ul>
<li>以上 2 つは、<a href="https://docs.docker.com/docker-for-mac/install/#system-requirements">Docker のヘルプページ</a>の内容に基づきます。</li>
</ul>
</li>
<li>Windows：Windows 10（詳細なバージョンは <a href="https://docs.docker.com/docker-for-windows/install/#system-requirements">Docker のヘルプページ</a>を参照してください。Windows の Edition（例えば Windows 10 Home や Windows 10 Pro など）によってバージョンが異なります。）</li>
</ul>
<h3>→ 解決方法</h3>
<p>OS のアップデートを試してください。</p>
<ul>
<li>macOS をお使いの方は、<a href="https://support.apple.com/ja-jp/HT201541">Apple のサポートページ</a>を参照してください。</li>
<li>Windows をお使いの方は、<a href="https://support.microsoft.com/ja-jp/windows/windows-10-%E3%82%92%E6%9B%B4%E6%96%B0%E3%81%99%E3%82%8B-3c5ae7fc-9fb6-9af1-1984-b5e0412c556a">Microsoft のサポートページ</a>を参照してください。</li>
</ul>
<p>なお、今後も OS のバージョンが古くなると、Docker が動かなくなる可能性があります。OS はこまめにアップデートすると良いでしょう。</p>
<br>
<h2>(2) <code>docker-compose up -d</code> （コンテナ起動）で失敗する<a id="2"></a></h2>
<h3>問題詳細</h3>
<p>Docker Desktop のインストールには成功したものの、コンテナ起動に失敗する場合があります。<br>
複数の原因が考えられます。</p>
<ul>
<li><a href="#2-1">・原因1（Windows、Mac）</a></li>
<li><a href="#2-2">・原因2（Windows、Mac）</a></li>
<li><a href="#2-3">・原因3（Windows、Mac）</a></li>
<li><a href="#2-4">・原因4（Windows のみ）</a></li>
</ul>
<h3>原因1（Windows、Mac）<a id="2-1"></a></h3>
<p>そもそも Docker Desktop が起動していない場合 <code>docker</code> コマンドを使用することはできません。<br>
デフォルトでは Docker Desktop は PC 起動時に同時に立ち上がる設定になっていることが多いのですが、PC の状態により起動していないケースもあります。</p>
<p>Docker Desktop が起動している場合、タスクバー（Windows）やメニューバー（Mac）にクジラのアイコンが <strong>止まって</strong> 表示されます。<br>
なお、クジラのアイコンが動いているのは起動中という意味です。</p>
<p>また、コマンドラインからも Docker Desktop のステータスを確認できます。</p>
<pre><code>docker version
</code></pre>
<p>というコマンドを入力した際に</p>
<pre><code>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
</code></pre>
<p>や</p>
<pre><code>Error response from daemon: dial unix docker.raw.sock: connect: connection refused
</code></pre>
<p>というメッセージが表示されなければ、正しく起動できているはずです。</p>
<h3>→ 原因1の解決方法</h3>
<p>アプリケーション一覧から Docker のアイコンをクリックし、起動してください。</p>
<br>
<h3>原因2（Windows、Mac）<a id="2-2"></a></h3>
<p>他の起動中の Docker コンテナと衝突して、新しくコンテナが起動できないことがあります。</p>
<p>例えば、次のようなエラーが表示されます。</p>
<pre><code>Starting sample_app_1 ... error

ERROR: for sample_app_1  Cannot start service app: driver failed programming external connectivity on endpoint sample_app_1 (5xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx0): Bind for 0.0.0.0:8000 failed: port is already allocated

...
</code></pre>
<h3>→ 原因2の解決方法</h3>
<p>どのディレクトリのコンテナが衝突しているかわかる場合は、当該ディレクトリに移動してコンテナを終了・破棄します。</p>
<pre><code>docker-compose down
</code></pre>
<p>わからない場合は、次のように<strong>全てのコンテナを終了・破棄</strong>します（コンテナは原則破棄するものなので、特に悪影響はありません）。</p>
<pre><code>docker stop $(docker ps -aq)
docker rm $(docker ps -aq)
</code></pre>
<p>再度起動したいコンテナのディレクトリに移動して、<code>docker-compose up -d</code> を試してみてください。</p>
<br>
<h3>原因3（Windows、Mac）<a id="2-3"></a></h3>
<p>Docker Desktop が正常に起動していない場合、次のように表示される場合があります。</p>
<pre><code>Traceback (most recent call last):
  File "urllib3/connectionpool.py", line 670, in urlopen
  File "urllib3/connectionpool.py", line 392, in _make_request
  File "http/client.py", line 1255, in request
  File "http/client.py", line 1301, in _send_request
  File "http/client.py", line 1250, in endheaders
...
</code></pre>
<h3>→ 原因3の解決方法</h3>
<p>Docker Desktop を再起動してみてください。</p>
<br>
<h3>原因4（Windows ユーザー向け）<a id="2-4"></a></h3>
<p>やや特殊ですが、過去に Docker Desktop ではなく <a href="https://docs.docker.jp/toolbox/overview.html">Docker Toolbox</a> を使って Docker を使用した経験のある方は、その際の設定が誤って読み込まれてしまうことがあります。</p>
<p>具体的には、以下のような環境変数が Docker Toolbox によって設定されてしまうことが問題になります。</p>
<pre><code>DOCKER_HOST
DOCKER_CERT_PATH
DOCKER_TLS_VERIFY
DOCKER_MACHINE_NAME
</code></pre>
<h3>→ 原因4の解決方法</h3>
<p><code>DOCKER_</code> で始まる環境変数を一括して削除します。</p>
<p>管理者権限で PowerShell を起動し、</p>
<pre><code>Remove-Item Env:DOCKER_*
</code></pre>
<p>と入力してください。</p>
<h2>(3) <code>(winpty) docker-compose exec app bash</code> で失敗する <a id="3"></a></h2>
<h3>表記について</h3>
<p>ここでは、表記を簡単にするため、<strong>Windows でのコマンドと Mac でのコマンドをまとめて「<code>(winpty) docker-compose exec app bash</code>」と書きます</strong>。そのため、Windows の場合は「<code>winpty docker-compose exec app bash</code>」に、Mac の場合は「<code>docker-compose exec app bash</code>」に、それぞれ読み替えてください。</p>
<h3>問題詳細</h3>
<p><code>docker-compose up -d</code>（コンテナ起動）には成功したものの、<code>(winpty) docker-compose exec app bash</code> でコンテナに入れない場合があります。</p>
<h3>原因</h3>
<p>Dockerfile を一度変更したことがあるにもかかわらず、<code>docker-compose up --build</code> でイメージをビルドし直していない可能性があります。</p>
<h3>→解決方法</h3>
<p><code>docker-compose up --build</code> 実行した後に、<code>(winpty) docker-compose exec app bash</code> を実行してみてください。</p>
</div></div></main><footer class=""><hr/><div class="px-5 pt-3 pb-5 bg-gray-700 text-sm text-white font-bold"><div class="max-w-4xl mx-auto"><span><a href="/faq/">FAQ・トラブルシューティング - N予備校プログラミングコース</a></span></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Docker 関連のトラブル","content":"\u003ch1\u003eDocker 関連のトラブル\u003c/h1\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003e目次\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#1\"\u003e(1) Docker Desktop がインストールできない\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#2\"\u003e(2) docker-compose up -d（コンテナ起動）で失敗する\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#3\"\u003e(3) (winpty) docker-compose exec app bash で失敗する\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e(1) Docker Desktop がインストールできない \u003ca id=\"1\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3\u003e問題詳細\u003c/h3\u003e\n\u003cp\u003eコンピュータの記憶容量の残りが十分あるにもかかわらず、Docker Desktop がインストールできない場合があります。\u003c/p\u003e\n\u003ch3\u003e原因\u003c/h3\u003e\n\u003cp\u003eOS が Docker が対応していない古いバージョンであることが原因です。\nDocker が対応している OS のバージョンは、次の通りです（2021.7.12 最終確認）。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emacOS（Intel の CPU を搭載する端末）：\u003cstrong\u003eバージョン 10.14（Mojave）以降\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003emacOS（Apple silicon を搭載する端末）：\u003cstrong\u003eRosetta 2 がインストールされていること\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e以上 2 つは、\u003ca href=\"https://docs.docker.com/docker-for-mac/install/#system-requirements\"\u003eDocker のヘルプページ\u003c/a\u003eの内容に基づきます。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWindows：Windows 10（詳細なバージョンは \u003ca href=\"https://docs.docker.com/docker-for-windows/install/#system-requirements\"\u003eDocker のヘルプページ\u003c/a\u003eを参照してください。Windows の Edition（例えば Windows 10 Home や Windows 10 Pro など）によってバージョンが異なります。）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e→ 解決方法\u003c/h3\u003e\n\u003cp\u003eOS のアップデートを試してください。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emacOS をお使いの方は、\u003ca href=\"https://support.apple.com/ja-jp/HT201541\"\u003eApple のサポートページ\u003c/a\u003eを参照してください。\u003c/li\u003e\n\u003cli\u003eWindows をお使いの方は、\u003ca href=\"https://support.microsoft.com/ja-jp/windows/windows-10-%E3%82%92%E6%9B%B4%E6%96%B0%E3%81%99%E3%82%8B-3c5ae7fc-9fb6-9af1-1984-b5e0412c556a\"\u003eMicrosoft のサポートページ\u003c/a\u003eを参照してください。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eなお、今後も OS のバージョンが古くなると、Docker が動かなくなる可能性があります。OS はこまめにアップデートすると良いでしょう。\u003c/p\u003e\n\u003cbr\u003e\n\u003ch2\u003e(2) \u003ccode\u003edocker-compose up -d\u003c/code\u003e （コンテナ起動）で失敗する\u003ca id=\"2\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3\u003e問題詳細\u003c/h3\u003e\n\u003cp\u003eDocker Desktop のインストールには成功したものの、コンテナ起動に失敗する場合があります。\u003cbr\u003e\n複数の原因が考えられます。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#2-1\"\u003e・原因1（Windows、Mac）\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#2-2\"\u003e・原因2（Windows、Mac）\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#2-3\"\u003e・原因3（Windows、Mac）\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#2-4\"\u003e・原因4（Windows のみ）\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e原因1（Windows、Mac）\u003ca id=\"2-1\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eそもそも Docker Desktop が起動していない場合 \u003ccode\u003edocker\u003c/code\u003e コマンドを使用することはできません。\u003cbr\u003e\nデフォルトでは Docker Desktop は PC 起動時に同時に立ち上がる設定になっていることが多いのですが、PC の状態により起動していないケースもあります。\u003c/p\u003e\n\u003cp\u003eDocker Desktop が起動している場合、タスクバー（Windows）やメニューバー（Mac）にクジラのアイコンが \u003cstrong\u003e止まって\u003c/strong\u003e 表示されます。\u003cbr\u003e\nなお、クジラのアイコンが動いているのは起動中という意味です。\u003c/p\u003e\n\u003cp\u003eまた、コマンドラインからも Docker Desktop のステータスを確認できます。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker version\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eというコマンドを入力した際に\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eCannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eや\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eError response from daemon: dial unix docker.raw.sock: connect: connection refused\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eというメッセージが表示されなければ、正しく起動できているはずです。\u003c/p\u003e\n\u003ch3\u003e→ 原因1の解決方法\u003c/h3\u003e\n\u003cp\u003eアプリケーション一覧から Docker のアイコンをクリックし、起動してください。\u003c/p\u003e\n\u003cbr\u003e\n\u003ch3\u003e原因2（Windows、Mac）\u003ca id=\"2-2\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e他の起動中の Docker コンテナと衝突して、新しくコンテナが起動できないことがあります。\u003c/p\u003e\n\u003cp\u003e例えば、次のようなエラーが表示されます。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eStarting sample_app_1 ... error\n\nERROR: for sample_app_1  Cannot start service app: driver failed programming external connectivity on endpoint sample_app_1 (5xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx0): Bind for 0.0.0.0:8000 failed: port is already allocated\n\n...\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e→ 原因2の解決方法\u003c/h3\u003e\n\u003cp\u003eどのディレクトリのコンテナが衝突しているかわかる場合は、当該ディレクトリに移動してコンテナを終了・破棄します。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker-compose down\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eわからない場合は、次のように\u003cstrong\u003e全てのコンテナを終了・破棄\u003c/strong\u003eします（コンテナは原則破棄するものなので、特に悪影響はありません）。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edocker stop $(docker ps -aq)\ndocker rm $(docker ps -aq)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e再度起動したいコンテナのディレクトリに移動して、\u003ccode\u003edocker-compose up -d\u003c/code\u003e を試してみてください。\u003c/p\u003e\n\u003cbr\u003e\n\u003ch3\u003e原因3（Windows、Mac）\u003ca id=\"2-3\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eDocker Desktop が正常に起動していない場合、次のように表示される場合があります。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eTraceback (most recent call last):\n  File \"urllib3/connectionpool.py\", line 670, in urlopen\n  File \"urllib3/connectionpool.py\", line 392, in _make_request\n  File \"http/client.py\", line 1255, in request\n  File \"http/client.py\", line 1301, in _send_request\n  File \"http/client.py\", line 1250, in endheaders\n...\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e→ 原因3の解決方法\u003c/h3\u003e\n\u003cp\u003eDocker Desktop を再起動してみてください。\u003c/p\u003e\n\u003cbr\u003e\n\u003ch3\u003e原因4（Windows ユーザー向け）\u003ca id=\"2-4\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eやや特殊ですが、過去に Docker Desktop ではなく \u003ca href=\"https://docs.docker.jp/toolbox/overview.html\"\u003eDocker Toolbox\u003c/a\u003e を使って Docker を使用した経験のある方は、その際の設定が誤って読み込まれてしまうことがあります。\u003c/p\u003e\n\u003cp\u003e具体的には、以下のような環境変数が Docker Toolbox によって設定されてしまうことが問題になります。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eDOCKER_HOST\nDOCKER_CERT_PATH\nDOCKER_TLS_VERIFY\nDOCKER_MACHINE_NAME\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e→ 原因4の解決方法\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eDOCKER_\u003c/code\u003e で始まる環境変数を一括して削除します。\u003c/p\u003e\n\u003cp\u003e管理者権限で PowerShell を起動し、\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eRemove-Item Env:DOCKER_*\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eと入力してください。\u003c/p\u003e\n\u003ch2\u003e(3) \u003ccode\u003e(winpty) docker-compose exec app bash\u003c/code\u003e で失敗する \u003ca id=\"3\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3\u003e表記について\u003c/h3\u003e\n\u003cp\u003eここでは、表記を簡単にするため、\u003cstrong\u003eWindows でのコマンドと Mac でのコマンドをまとめて「\u003ccode\u003e(winpty) docker-compose exec app bash\u003c/code\u003e」と書きます\u003c/strong\u003e。そのため、Windows の場合は「\u003ccode\u003ewinpty docker-compose exec app bash\u003c/code\u003e」に、Mac の場合は「\u003ccode\u003edocker-compose exec app bash\u003c/code\u003e」に、それぞれ読み替えてください。\u003c/p\u003e\n\u003ch3\u003e問題詳細\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003edocker-compose up -d\u003c/code\u003e（コンテナ起動）には成功したものの、\u003ccode\u003e(winpty) docker-compose exec app bash\u003c/code\u003e でコンテナに入れない場合があります。\u003c/p\u003e\n\u003ch3\u003e原因\u003c/h3\u003e\n\u003cp\u003eDockerfile を一度変更したことがあるにもかかわらず、\u003ccode\u003edocker-compose up --build\u003c/code\u003e でイメージをビルドし直していない可能性があります。\u003c/p\u003e\n\u003ch3\u003e→解決方法\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003edocker-compose up --build\u003c/code\u003e 実行した後に、\u003ccode\u003e(winpty) docker-compose exec app bash\u003c/code\u003e を実行してみてください。\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/[...slug]","query":{"slug":["intro","docker"]},"buildId":"T1vjYJgyrlBWundsx9FW2","assetPrefix":"/faq","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>